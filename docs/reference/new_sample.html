<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Generate particles and select one to be the new sample — new_sample • pmwg</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Generate particles and select one to be the new sample — new_sample"><meta property="og:description" content="Generate a new sample for a particular subject given their data and the
new model parameter estimates. This should not be called directly, rather it
is used internally to run_stage."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pmwg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/pmwg.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../FAQ.html">FAQ</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">Releases</li>
    <li>
      <a href="https://university-of-newcastle-research.github.io/NewcastleCL.github.io//2021/02/10/PMWG-version-0.2.0-released.html" class="external-link">pmwg 0.2.0</a>
    </li>
    <li class="divider">
    <li>
      <a href="../news/index.html">Changelog</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/university-of-newcastle-research/pmwg/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generate particles and select one to be the new sample</h1>
    <small class="dont-index">Source: <a href="https://github.com/university-of-newcastle-research/pmwg/blob/HEAD/R/sampling.R" class="external-link"><code>R/sampling.R</code></a></small>
    <div class="hidden name"><code>new_sample.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Generate a new sample for a particular subject given their data and the
new model parameter estimates. This should not be called directly, rather it
is used internally to run_stage.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">new_sample</span><span class="op">(</span></span>
<span>  <span class="va">s</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">num_particles</span>,</span>
<span>  <span class="va">parameters</span>,</span>
<span>  efficient_mu <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  efficient_sig2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mix_proportion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  likelihood_func <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  epsilon <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  subjects <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>s</dt>
<dd><p>A number - the index of the subject. For <code>s == 1</code> The first
subject ID from the <code>data</code> subject column will be selected. For
<code>s == 2</code> the second unique value for subject id will be used.</p></dd>


<dt>data</dt>
<dd><p>A data.frame (or similar object) which contains the data against
which the particles are assessed. The only strict requirement is that
it contains a subject column named as such to allow for the splitting
of the data by unique subject id. The provided log likelihood function
is the only other contact with the data.</p></dd>


<dt>num_particles</dt>
<dd><p>The total number of particles to generate using a
combination of the three methods.</p></dd>


<dt>parameters</dt>
<dd><p>A list containing:</p><dl><dt><code>tmu</code></dt>
<dd><p>The vector of means for the multivariate normal</p></dd>

  <dt><code>tsig</code></dt>
<dd><p>A covariate matrix for the multivariate normal</p></dd>

  <dt><code>alpha</code></dt>
<dd><p>An array of individual subject random effects</p></dd>


</dl></dd>


<dt>efficient_mu</dt>
<dd><p>The mu value for the efficient proposals</p></dd>


<dt>efficient_sig2</dt>
<dd><p>The sigma value for the efficient proposals</p></dd>


<dt>mix_proportion</dt>
<dd><p>A vector of floats between 0 and 1 and summing to 1
which give the proportion of particles to generate from the population
level parameters, the individual random effects and the conditional
parameters respectively</p></dd>


<dt>likelihood_func</dt>
<dd><p>A likelihood function for calculating log likelihood
of samples. Usually provided internally in <code>run_stage</code> from the pmwgs
object.</p></dd>


<dt>epsilon</dt>
<dd><p>A scaling factor to reduce the variance on the distribution
based on subject random effects when generating particles.</p></dd>


<dt>subjects</dt>
<dd><p>A list of unique subject ids in the order they appear in
the data.frame</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A single sample from the new proposals</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The function that controls the generation of new samples for the Particle
Metropolis within Gibbs sampler. It generates samples from either the initial
proposal or from the last iteration of the sampler. This function should not
usually need to be called, as the <code>run_stage</code> function uses this
internally.</p>
<p>The way it selects a new sample is by generating proposal particles from up
to three different distributions (according to a mixing proportion).</p>
<p>The first distribution is based on the current model parameter sample values.
The second distribution is based on the last random effects for the subject.
The third distribution is only used in the final sampling phase and is based
on the conditional distribution built from accepted particles in the adapt
phase of the sampler.</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Gavin Cooper, Reilly Innes, Caroline Kuhne, Jon-Paul Cavallaro, David Gunawan, Guy Hawkins, Scott Brown, Niek Stevenson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

